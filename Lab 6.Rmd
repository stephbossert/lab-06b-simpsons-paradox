---
title: "Lab 6"
author: "Steph Bossert"
date: "3/10/2021"
output: html_document
---

```{r}
library(tidyverse) 
library(dplyr)
install.packages("mosaicData",repos = "http://cran.us.r-project.org")
library(mosaicData) 
```

###Exercise 1
###What type of study do you think these data comne from: observational or experiment? Why?
####Observational- the data seems to be collected in a way that doesn't interfere with the "process", or the way the data was collected

###Exercise 2
###How many observations are in this dataset? What does each observation represent?
###1314 observations representing data on particapnts 


###Exercise 3
###How many variables are in this dataset? What type of variable is each? Display each variable using an appropriate visualization.
###3 variables- Outcome & Smoker- explanatory; age: response variable
```{r}
ggplot(data=Whickham, aes(x=outcome)) +
  geom_bar(stat="count")
ggplot(data=Whickham, aes(x=age)) +
  geom_bar(stat="count")
ggplot(data=Whickham, aes(x=smoker)) +
  geom_bar(stat="count")
```

###Exercise 4
###What would you expect the relationship between smoking status and health outcome to be?
###The more people smoke, less likely they'll be alive, inverse relationship between smoking status and health outcome

###Exercise 5
```{r}
view(Whickham)
Whickham %>%
  count(smoker,outcome) %>%
  group_by(smoker) %>%
  mutate(prop_death = n / sum(n)) %>%
  ungroup()
ggplot(Whickham, aes(x = outcome, 
                     fill = smoker)) +
  geom_bar(position = "fill") + 
  labs(title = "Health Outcomes",
       y = NULL, x = NULL)
```
###I expected the disparity to be much larger, so more people who smoke to be dead vs. alive. 
###Exercise 6
```{r}
Whickham<- Whickham %>%
  mutate(age_cat= case_when(age <= "44" ~ "18-44",
                             age > "44" & age <= "64" ~ "45-64",
                             age > "64" ~ "65+"))
Whickham<- Whickham %>%
  mutate(outcome_smoker= case_when(outcome == "Alive" & smoker == "Yes" ~ "Smoker_n_Alive",
                                   outcome == "Alive" & smoker == "No" ~ "Nonsmoker_n_Alive", 
                                   outcome == "Dead" & smoker == "Yes" ~ "Smoker_n_Dead", 
                                   outcome == "Dead" & smoker == "No" ~ "Nonsmoker_n_Alive"))
view(Whickham)
```

###Exercise 7
```{r}
Whickham %>%
  count(smoker, age_cat, outcome)
Whickham %>%
  count(smoker, outcome)

ggplot(Whickham, aes(x = outcome_smoker, 
                     fill = age_cat)) +
  geom_bar(stat ="count", position = position_dodge())
  labs(title = "Health Outcomes",
       y = NULL, x = NULL)
```
###relationship between smoking and health outcome became much stronger when accounting for age. Comparing the 65+ category, those who didn't smoke had a much greater chance of being alive. 



